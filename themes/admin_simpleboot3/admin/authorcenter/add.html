<include file="public@header" />
</head>
<style>
	.text-input {
		width: 150px;
		margin-bottom: 10px;
		margin-right: 10px;
	}
	.input_area span {
		position: absolute;
		right: 5px;
		top: -8px;
		cursor: pointer;
	}
	.input_area {
		float: left;
		position: relative;
	}
	p {
		margin: 0 0 10px;
	}
	.help-block {
		display: block;
		margin-top: 5px;
		margin-bottom: 10px;
		color: #597ea2;
	}
	.clearboth {
		clear: both;
	}
</style>
<body>
	<div class="wrap">
		<ul class="nav nav-tabs">
			<li ><a href="{:url('Authorcenter/index')}">活动列表</a></li>
			<li class="active"><a >{:lang('ADD')}活动</a></li>
		</ul>
		<form method="post" class="form-horizontal js-ajax-form margin-top-20" action="{:url('Authorcenter/addPost')}">

			<div class="form-group">
				<label for="input-title" class="col-sm-2 control-label"><span class="form-required">*</span>活动标题</label>
				<div class="col-md-6 col-sm-10">
					<input type="text" class="form-control" id="input-title" name="title">
				</div>
			</div>
			<div class="form-group">
				<label for="input-title_en" class="col-sm-2 control-label"><span class="form-required">*</span>Activity Title</label>
				<div class="col-md-6 col-sm-10">
					<input type="text" class="form-control" id="input-title_en" name="title_en">
					<volist name="list_language" id="v">
						<input style="margin-top: 5px" type="text" class="form-control" id="input-{$v.code}" name="language[{$v.code}]" placeholder="{$v.language_title}">
					</volist>
				</div>
			</div>

			<div class="form-group">
				<label for="input-title" class="col-sm-2 control-label"><span class="form-required">*</span>所属分类</label>
				<div class="col-md-6 col-sm-10">
					<select class="select_2 form-control valid" name="classifyid" style="width: 200px;" aria-invalid="false">
						<volist name="classify" id="v">
							<option value="{$key}" <if condition="input('request.classifyid') neq '' && input('request.classifyid') eq $key">selected</if> >{$v}</option>
						</volist>
					</select>
				</div>
			</div>

			<div class="form-group">
				<label for="input-user_login" class="col-sm-2 control-label"><span class="form-required">*</span>活动封面</label>
				<div class="col-md-6 col-sm-10">
					<input type="hidden" name="thumb" id="thumb" value="">
					<a href="javascript:uploadOneImage('图片上传','#thumb');">
						<img src="/../themes/admin_simpleboot3/public/assets/images/default-thumbnail.png" id="thumb-preview" style="cursor: pointer;max-width:150px;max-height:150px;">
					</a>
					<input type="button" class="btn btn-sm btn-cancel-thumb" value="取消图片">
				</div>
			</div>

			<div class="form-group">
				<label for="input-active_start_time" class="col-sm-2 control-label"><span class="form-required">*</span>活动开始时间</label>
				<div class="col-md-6 col-sm-10">
					<input type="text" class="js-bootstrap-date form-control" id="input-active_start_time" name="active_start_time" autocomplete="off" style="width: 200px;">
				</div>
			</div>

			<div class="form-group">
				<label for="input-active_end_time" class="col-sm-2 control-label"><span class="form-required">*</span>活动结束时间</label>
				<div class="col-md-6 col-sm-10">
					<input type="text" class="js-bootstrap-date form-control" id="input-active_end_time" name="active_end_time" autocomplete="off" style="width: 200px;">
				</div>
			</div>

			<div class="form-group">
				<label for="input-submission_start_time" class="col-sm-2 control-label"><span class="form-required">*</span>投稿开始时间</label>
				<div class="col-md-6 col-sm-10">
					<input type="text" class="js-bootstrap-date form-control" id="input-submission_start_time" name="submission_start_time" autocomplete="off" style="width: 200px;">
				</div>
			</div>

			<div class="form-group">
				<label for="input-submission_end_time" class="col-sm-2 control-label"><span class="form-required">*</span>投稿结束时间</label>
				<div class="col-md-6 col-sm-10">
					<input type="text" class="js-bootstrap-date form-control" id="input-submission_end_time" name="submission_end_time" autocomplete="off" style="width: 200px;">
				</div>
			</div>

			<div class="form-group">
				<label for="input-activity_play" class="col-sm-2 control-label"><span class="form-required">*</span>活动玩法</label>
				<div class="col-md-6 col-sm-10">
					<textarea class="form-control" rows="2" cols="20" id="input-activity_play" name="activity_play" style="height: 100px; width: 500px;"></textarea>
				</div>
			</div>

			<div class="form-group" id="input-container">
				<label class="col-sm-2 control-label"><span class="form-required">*</span>关联话题</label>
				<div class="col-md-6 col-sm-10">
					<input type="text" class="form-control text-input" data-id="normal" style="float: left;" name="related_topics[]" placeholder="请输入关联话题">
					<p class="clearboth"></p>
					<p class="help-block">输入关联话题后，点击回车键，自动出现下一个输入框</p>
				</div>
			</div>

			<div class="form-group">
				<label for="input-activity_reward" class="col-sm-2 control-label"><span class="form-required">*</span>活动奖励</label>
				<div class="col-md-6 col-sm-10">
					<textarea class="form-control" rows="2" cols="20" id="input-activity_reward" name="activity_reward" style="height: 100px; width: 500px;"></textarea>
				</div>
			</div>

			<div class="form-group">
				<label class="col-sm-2 control-label"><span class="form-required">*</span>显示状态</label>
				<div class="col-md-6 col-sm-10">
					<label class="radio-inline"><input type="radio" name="is_status" value="0">不显示</label>
					<label class="radio-inline"><input type="radio" name="is_status" value="1" checked="">显示</label>
				</div>
			</div>
            
			<div class="form-group">
				<div class="col-sm-offset-2 col-sm-10">
					<button type="submit" class="btn btn-primary js-ajax-submit">{:lang('ADD')}</button>
					<a class="btn btn-default" href="javascript:history.back(-1);">{:lang('BACK')}</a>
				</div>
			</div>
            
		</form>
	</div>
	<script src="__STATIC__/js/admin.js"></script>
	<script type="text/javascript">
		$(function(){

			$('.btn-cancel-thumb').click(function () {
				$('#thumb-preview').attr('src', '/../themes/admin_simpleboot3/public/assets/images/default-thumbnail.png');
				$('#thumb').val('');
			});

			$('#input-container').on('keydown', '.text-input', function(e) {
				if (e.which === 13) { // 检查按键是否是回车键
					e.preventDefault(); // 阻止默认回车事件
					var val=$(this).val().replace(/\s+/g, '');
					console.log(val);
					if(val==''){
						layer.msg('请填写关联话题');
						return;
					}

					$(this).val(val);
					//$(this).attr('disabled', true); // 禁用当前输入框

					if($(this).data('id')=='normal'){
						$(this).after(`
			            	<p class="input_area">
			            	<input type="text" class="form-control text-input" name="related_topics[]" placeholder="请输入关联话题" >
			            	<span>×</span>
			            	</p>
			            `); // 添加新的输入框

						$(this).next().children('input').focus();
					}else{
						$(this).parent().after(`
			            	<p class="input_area">
			            	<input type="text" class="form-control text-input" name="related_topics[]" placeholder="请输入关联话题" >
			            	<span>×</span>
			            	</p>
			            `); // 添加新的输入框

						$(this).parent().next().children('input').focus();
					}


				}
			});

			$('#input-container').on('click','.input_area span',function(){
				$(this).parent().remove();
			});
		});
	</script>
</body>
</html>
